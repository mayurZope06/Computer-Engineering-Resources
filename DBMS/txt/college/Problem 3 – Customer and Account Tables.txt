üè¶ Problem 3 ‚Äì Customer and Account Tables
üéØ Objective:

Create Customer and Account tables ‚Üí perform joins and conditional queries.

‚úÖ 1. Create Tables
CREATE TABLE Customer (
  C_id INT PRIMARY KEY,
  Cname VARCHAR(50),
  City VARCHAR(50)
);

CREATE TABLE Account (
  Acc_no INT PRIMARY KEY,
  C_id INT,
  Acc_Type VARCHAR(20),
  Amount DECIMAL(10,2),
  FOREIGN KEY (C_id) REFERENCES Customer(C_id)
);

‚úÖ 2. Insert Sample Data
INSERT INTO Customer VALUES (1, 'Pooja', 'Pune');
INSERT INTO Customer VALUES (2, 'Amit', 'Nashik');
INSERT INTO Customer VALUES (3, 'Raj', 'Pune');
INSERT INTO Customer VALUES (4, 'Neha', 'Mumbai');

INSERT INTO Account VALUES (101, 1, 'Saving', 25000);
INSERT INTO Account VALUES (102, 2, 'Current', 18000);
INSERT INTO Account VALUES (103, 3, 'Saving', 30000);
INSERT INTO Account VALUES (104, 4, 'Current', 12000);

‚úÖ 3. Show cname, Acc_Type, and amount for customers having a Saving account
SELECT c.Cname, a.Acc_Type, a.Amount
FROM Customer c
JOIN Account a ON c.C_id = a.C_id
WHERE a.Acc_Type = 'Saving';

‚úÖ 4. Display data using NATURAL, LEFT, and RIGHT joins

Natural Join:

SELECT * FROM Customer NATURAL JOIN Account;


Left Join:

SELECT c.Cname, a.Acc_Type, a.Amount
FROM Customer c
LEFT JOIN Account a ON c.C_id = a.C_id;


Right Join:

SELECT c.Cname, a.Acc_Type, a.Amount
FROM Customer c
RIGHT JOIN Account a ON c.C_id = a.C_id;

‚úÖ 5. Display customers living in the same city as ‚ÄòPooja‚Äô
SELECT * 
FROM Customer
WHERE City = (SELECT City FROM Customer WHERE Cname = 'Pooja');

‚úÖ 6. Display account info having amount less than average amount
SELECT * 
FROM Account
WHERE Amount < (SELECT AVG(Amount) FROM Account);

‚úÖ 7. Display C_id having maximum amount in account
SELECT C_id 
FROM Account
WHERE Amount = (SELECT MAX(Amount) FROM Account);

‚úÖ 8. Display amount & acc_type of customers with minimum amount per Acc_Type
SELECT Acc_Type, Amount
FROM Account a1
WHERE Amount = (
  SELECT MIN(Amount)
  FROM Account a2
  WHERE a1.Acc_Type = a2.Acc_Type
);

‚úÖ 9. Display accounts whose amount is higher than ANY saving account amount
SELECT * 
FROM Account
WHERE Amount > ANY (SELECT Amount FROM Account WHERE Acc_Type = 'Saving');

üí° Viva Tips

NATURAL JOIN automatically matches columns with same names.

LEFT JOIN ‚Üí all rows from left table + matching from right.

RIGHT JOIN ‚Üí all rows from right table + matching from left.

ANY / ALL ‚Üí used with subqueries for comparison.

AVG(), MAX(), MIN() ‚Üí aggregate functions.