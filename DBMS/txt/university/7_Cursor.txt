ðŸ§© Problem Statement 7: Parameterized Cursor (MySQL Equivalent)
âœ… Code:
DROP TABLE IF EXISTS o_rollcall;
DROP TABLE IF EXISTS n_rollcall;

CREATE TABLE o_rollcall (roll_no INT PRIMARY KEY, name VARCHAR(30));
CREATE TABLE n_rollcall (roll_no INT PRIMARY KEY, name VARCHAR(30));

INSERT INTO o_rollcall VALUES (1, 'Amit'), (2, 'Riya');
INSERT INTO n_rollcall VALUES (2, 'Riya'), (3, 'Raj');

DELIMITER $$

CREATE PROCEDURE merge_rollcall()
BEGIN
  DECLARE done INT DEFAULT 0;
  DECLARE r INT;
  DECLARE n VARCHAR(30);
  DECLARE v_count INT;

  DECLARE cur CURSOR FOR SELECT roll_no, name FROM n_rollcall;
  DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = 1;

  OPEN cur;
  read_loop: LOOP
    FETCH cur INTO r, n;
    IF done THEN
      LEAVE read_loop;
    END IF;

    SELECT COUNT(*) INTO v_count FROM o_rollcall WHERE roll_no = r;
    IF v_count = 0 THEN
      INSERT INTO o_rollcall VALUES (r, n);
    END IF;
  END LOOP;
  CLOSE cur;
END$$

DELIMITER ;

-- Execute
CALL merge_rollcall();
SELECT * FROM o_rollcall;
