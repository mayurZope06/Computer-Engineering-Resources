ðŸ§© Problem Statement 4: SQL DML â€“ Joins, Subquery, View
âœ… Code:
DROP TABLE IF EXISTS student;
DROP TABLE IF EXISTS department;

CREATE TABLE student (
  roll_no INT PRIMARY KEY,
  name VARCHAR(50),
  dept_id INT,
  marks INT
);

CREATE TABLE department (
  dept_id INT PRIMARY KEY,
  dept_name VARCHAR(30),
  location VARCHAR(30)
);

-- Insert data
INSERT INTO department VALUES
(1, 'CSE', 'Block A'),
(2, 'IT', 'Block B'),
(3, 'ENTC', 'Block C');

INSERT INTO student VALUES
(101, 'Amit', 1, 950),
(102, 'Riya', 2, 880),
(103, 'Raj', 3, 760),
(104, 'Neha', 1, 990);

-- 1. INNER JOIN
SELECT s.name, d.dept_name, d.location
FROM student s
INNER JOIN department d ON s.dept_id = d.dept_id;

-- 2. LEFT JOIN
SELECT s.name, d.location
FROM student s LEFT JOIN department d ON s.dept_id = d.dept_id;

-- 3. RIGHT JOIN
SELECT s.name, d.location
FROM student s RIGHT JOIN department d ON s.dept_id = d.dept_id;

-- 4. CROSS JOIN
SELECT s.name, d.dept_name FROM student s CROSS JOIN department d;

-- 5. Subquery: above average
SELECT * FROM student
WHERE marks > (SELECT AVG(marks) FROM student);

-- 6. Subquery with IN
SELECT * FROM student
WHERE dept_id IN (SELECT dept_id FROM department WHERE location='Block A');

-- 7. Create View
CREATE VIEW v_stud_dept AS
SELECT s.name, s.marks, d.location
FROM student s JOIN department d ON s.dept_id = d.dept_id;

-- 8. Select from view
SELECT * FROM v_stud_dept;

-- 9. Topper
SELECT name, marks FROM student
WHERE marks = (SELECT MAX(marks) FROM student);

-- 10. Students from specific departments
SELECT name FROM student WHERE dept_id IN (1, 2);
