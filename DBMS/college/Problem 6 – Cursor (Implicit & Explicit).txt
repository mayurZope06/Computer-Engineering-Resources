ðŸ’¾ Problem 6 â€“ Cursor (Implicit & Explicit)
ðŸŽ¯ Objective: Merge data from N_RollCall â†’ O_RollCall, skip duplicates.
âœ… Create Tables
CREATE TABLE N_RollCall (Roll INT PRIMARY KEY, Name VARCHAR(50));
CREATE TABLE O_RollCall (Roll INT PRIMARY KEY, Name VARCHAR(50));

âœ… Insert Sample Data
INSERT INTO N_RollCall VALUES (1, 'Amit');
INSERT INTO N_RollCall VALUES (2, 'Pooja');

INSERT INTO O_RollCall VALUES (1, 'Amit');
INSERT INTO O_RollCall VALUES (3, 'Raj');

âœ… PL/SQL Block Using Parameterized Cursor
DECLARE
    CURSOR cur_new IS SELECT Roll, Name FROM N_RollCall;
    v_roll N_RollCall.Roll%TYPE;
    v_name N_RollCall.Name%TYPE;
    v_count NUMBER;
BEGIN
    OPEN cur_new;
    LOOP
        FETCH cur_new INTO v_roll, v_name;
        EXIT WHEN cur_new%NOTFOUND;

        SELECT COUNT(*) INTO v_count FROM O_RollCall WHERE Roll = v_roll;

        IF v_count = 0 THEN
            INSERT INTO O_RollCall VALUES (v_roll, v_name);
            DBMS_OUTPUT.PUT_LINE('Inserted: ' || v_name);
        ELSE
            DBMS_OUTPUT.PUT_LINE('Skipped: ' || v_name);
        END IF;
    END LOOP;
    CLOSE cur_new;
END;
/







ðŸ’¾ Problem 6 â€“ Cursor (MySQL Version)

MySQL cursors work only inside stored procedures, so hereâ€™s the equivalent.

CREATE TABLE N_RollCall (Roll INT PRIMARY KEY, Name VARCHAR(50));
CREATE TABLE O_RollCall (Roll INT PRIMARY KEY, Name VARCHAR(50));

INSERT INTO N_RollCall VALUES (1, 'Amit'), (2, 'Pooja');
INSERT INTO O_RollCall VALUES (1, 'Amit'), (3, 'Raj');

DELIMITER $$

CREATE PROCEDURE MergeRollCall()
BEGIN
    DECLARE v_roll INT;
    DECLARE v_name VARCHAR(50);
    DECLARE done INT DEFAULT 0;

    DECLARE cur_new CURSOR FOR SELECT Roll, Name FROM N_RollCall;
    DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = 1;

    OPEN cur_new;

    read_loop: LOOP
        FETCH cur_new INTO v_roll, v_name;
        IF done THEN
            LEAVE read_loop;
        END IF;

        IF (SELECT COUNT(*) FROM O_RollCall WHERE Roll = v_roll) = 0 THEN
            INSERT INTO O_RollCall VALUES (v_roll, v_name);
            SELECT CONCAT('Inserted: ', v_name) AS Message;
        ELSE
            SELECT CONCAT('Skipped: ', v_name) AS Message;
        END IF;
    END LOOP;

    CLOSE cur_new;
END$$

DELIMITER ;


âœ… Run:

CALL MergeRollCall();
SELECT * FROM O_RollCall;