ðŸ§  Problem 9 â€“ Trigger (Library Audit)
âœ… Tables
CREATE TABLE Library (
  Book_ID INT PRIMARY KEY,
  Book_Name VARCHAR(50),
  Author VARCHAR(50)
);

CREATE TABLE Library_Audit (
  Book_ID INT,
  Book_Name VARCHAR(50),
  Author VARCHAR(50),
  Operation VARCHAR(10),
  ChangeDate DATE
);

âœ… Trigger
CREATE OR REPLACE TRIGGER trg_Library_Audit
AFTER DELETE OR UPDATE ON Library
FOR EACH ROW
BEGIN
  IF DELETING THEN
    INSERT INTO Library_Audit VALUES(:OLD.Book_ID, :OLD.Book_Name, :OLD.Author, 'DELETE', SYSDATE);
  ELSIF UPDATING THEN
    INSERT INTO Library_Audit VALUES(:OLD.Book_ID, :OLD.Book_Name, :OLD.Author, 'UPDATE', SYSDATE);
  END IF;
END;
/









ðŸ§  Problem 9 â€“ Trigger (Library Audit â€“ MySQL)
CREATE TABLE Library (
  Book_ID INT PRIMARY KEY,
  Book_Name VARCHAR(50),
  Author VARCHAR(50)
);

CREATE TABLE Library_Audit (
  Book_ID INT,
  Book_Name VARCHAR(50),
  Author VARCHAR(50),
  Operation VARCHAR(10),
  ChangeDate DATETIME
);

DELIMITER $$

CREATE TRIGGER trg_Library_Audit_Update
AFTER UPDATE ON Library
FOR EACH ROW
BEGIN
    INSERT INTO Library_Audit
    VALUES (OLD.Book_ID, OLD.Book_Name, OLD.Author, 'UPDATE', NOW());
END$$

CREATE TRIGGER trg_Library_Audit_Delete
AFTER DELETE ON Library
FOR EACH ROW
BEGIN
    INSERT INTO Library_Audit
    VALUES (OLD.Book_ID, OLD.Book_Name, OLD.Author, 'DELETE', NOW());
END$$

DELIMITER ;

-- Test
INSERT INTO Library VALUES (1, 'DBMS', 'Navathe');
UPDATE Library SET Author='Korth' WHERE Book_ID=1;
DELETE FROM Library WHERE Book_ID=1;

SELECT * FROM Library_Audit;